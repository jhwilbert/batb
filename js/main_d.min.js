var player,videoElement,threshold=50,keysEnabled=!0,videoStatus={},timer,timeron=!1,noiseon=!0,DEBUG=!1,copyLink="CLICK HERE FOR MORE INFORMATION & TICKETS";
function startApp(){DEBUG&&console.log("Page ready...");$("#container").append('<div id="loader"><img src="imgs/loader.gif">Loading TV</div>');$(window).focus(function(){DEBUG&&console.log("Window has focus")});$(window).resize(function(){positionNoise()});$(document).keypress(function(a){a=$.browser.msie?a.keyCode:a.charCode;keysEnabled?32==a&&(player.nextVideo(),videoInterrupted(player.getDuration(),player.getCurrentTime())):DEBUG&&console.log("detectKey(e) :: keys are disabled at this point")});
loadNoiseVideo()}function loadNoiseVideo(){DEBUG&&console.log("loadNoiseVideo() :: Loading Noise...");var a=new Image;a.src="imgs/noise.gif";a.onload=function(){noiseLoaded(a)}}
function noiseLoaded(a){$("#container").append('<div id="video-container"></div>');$("#container").append('<div id="link-container">'+copyLink+"</div>");$("#video-container").append(a);positionNoise();$("#link-container").click(function(){player.pauseVideo();$(this).target="_blank";window.open("/r");return!1});$("#loader").remove();$("#video-container").css("opacity","1");DEBUG&&console.log("noiseLoaded() :: Noise Loaded! Loading playlist");loadPlayer()}
function videoInterrupted(a,b){if(0!=a&&0!=b){var c=Math.round(100*(b/a)),d=player.getPlaylistIndex();DEBUG&&console.log("videoInterrupted() :: Duration:",a,"CurrentTime:",b,"PercentPlayed",c+"%","video index",player.getPlaylistIndex());storeStatus(d,c)}else DEBUG&&console.log("videoInterrupted() :: Film hasn't started",a,b)}
function storeStatus(a,b){videoStatus[a]=b;DEBUG&&console.log("storeStatus() ::",videoStatus);1<a&&a<videosDesktop.length-1?checkWatched():1>a?DEBUG&&console.log("storeStatus() :: Still Gathering Data"):a==videosDesktop.length-1&&DEBUG&&console.log("storeStatus() :: Last Video No Storing")}
function storeStatusPlayed(){if(0<player.getPlaylistIndex()){var a=player.getPlaylistIndex()-1;void 0==videoStatus[a]&&player.getPlaylistIndex()!=videosDesktop.length-1&&(DEBUG&&console.log("storeStatusPlayed() :: Previous Played fully"),storeStatus(a,100))}}
function checkWatched(){var a=Math.round(updateTotalPercent());a>threshold?DEBUG&&console.log("checkWatched() :: Overall Percent Watched:",a,"All Good, let's keep playing videos"):(DEBUG&&console.log("checkWatched() :: Overall Percent Watched:",a," ** SKIPPED TO MUCH ** Play Barbican Card Next",videosDesktop.length-1),player.playVideoAt(videosDesktop.length-1))}function updateTotalPercent(){var a=0,b=0;$.each(videoStatus,function(c,d){a+=d;b++});return a/b}
function loadPlayer(){DEBUG&&console.log("loadPlayer() :: Loading Player ...");$("#container").append('<div id="player"></div>');$("#player").css("opacity","0");var a=document.createElement("script");a.src="//www.youtube.com/iframe_api";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}
function onPlayerReady(){DEBUG&&console.log("onPlayerReady(e) :: Calling noise and cueing playlist...",videosDesktop);$("#player").css("opacity","1");player.cuePlaylist(videosDesktop,0,0,"medium");(-1<navigator.userAgent.toLowerCase().indexOf("chrome")||!0==$.browser.msie)&&player.playVideoAt(0);startCheck()}function onPlayerError(a){DEBUG&&console.log("onPlayerError() :: Error",a)}
function onYouTubeIframeAPIReady(){DEBUG&&console.log("onYouTubeIframeAPIReady() :: IframeAPIReady...");player=new YT.Player("player",{events:{onReady:onPlayerReady,onStateChange:onytplayerStateChange,onError:onPlayerError},playerVars:{autoplay:1,controls:0,showinfo:0,modestbranding:1,wmode:"opaque",disablekb:1,enablejsapi:1,origin:window.location.host,rel:0},width:"100%",height:"100%"})}
function checkPlay(){DEBUG&&console.log("checkPlay() :: CurrentTime:",player.getCurrentTime(),"Totaltime",player.getDuration());0<player.getCurrentTime()&&player.getCurrentTime()<player.getDuration()-0.5&&hideNoise();0!=player.getCurrentTime()&&player.getCurrentTime()>player.getDuration()-0.5&&showNoise()}function showNoise(){noiseon||(DEBUG&&console.log("hidenoise() :: Noise fadein..."),$("#link-container").hide(),$("#video-container").fadeIn(),noiseon=!0)}
function hideNoise(){noiseon&&(DEBUG&&console.log("hidenoise() :: Noise fadeout..."),$("#link-container").show(),$("#video-container").fadeOut(),noiseon=!1)}function startCheck(){DEBUG&&console.log("startCheck() :: Starting Timer");timeron||(timer=setInterval("checkPlay()",300));timeron=!0}function stopCheck(){timeron&&(clearInterval(timer),timeron=!1,DEBUG&&console.log("stopCheck() :: Stopping Timer"),$("#video-container").fadeOut())}
function restartPlaylist(){DEBUG&&console.log("restartPlaylist() :: restarting playlist ...");player.playVideoAt(0);videoStatus={}}
function onytplayerStateChange(a){switch(a.data){case 0:DEBUG&&console.log("------------------------------- onytplayerStateChange() :: State",a.data,"End Playlist -----------------------------");restartPlaylist();window.focus();break;case 1:DEBUG&&(console.log("------------------------------- onytplayerStateChange() :: State",a.data,"Playing ----------------------------------"),console.log("Playing........",player.getPlaylistIndex()));keysEnabled=!0;window.focus();break;case -1:DEBUG&&(console.log("------------------------------- onytplayerStateChange() :: State",
a.data,"Unstarted -------------------------------"),console.log("onytplayerStateChange(): Availible:",player.getAvailableQualityLevels(),"Decided:",player.getPlaybackQuality()));player.setPlaybackQuality("medium");showNoise();window.focus();paused=!0;keysEnabled=!1;break;case 2:DEBUG&&console.log("------------------------------- onytplayerStateChange() :: State",a.data,"Paused ----------------------------------");window.focus();break;case 3:DEBUG&&console.log("------------------------------- onytplayerStateChange() :: State",
a.data,"Buffering -------------------------------")}}function centerElement(a){$(window).width();$(window).height();$(a).width();$(a).height();var b=$(window).width()/2-$(a).width()/2,c=$(window).height()/2-$(a).height()/2;$(a).css("top",c+"px");$(a).css("left",b+"px")}
function positionNoise(){var a=$(window).width(),b=$(window).height();a>b&&(nWidth=540*(a/540),nHeight=nWidth/1.77,nHeight>b&&(nWidth=nWidth*b/nHeight,nHeight=nWidth/1.77));a<b&&(nHeight=305*(b/305),nWidth=1.77*nHeight,nWidth>a&&(nHeight=nHeight*a/nWidth,nWidth=1.77*nHeight));var b=$("#video-container").find("img"),a=$(window).height()/2-nHeight/2,c=$(window).width()/2-nWidth/2;$(b).css("width",Math.round(nWidth)+"px");$(b).css("height",Math.round(nHeight)+"px");$("#video-container").css("top",Math.round(a)+
"px");$("#video-container").css("left",Math.round(c)+"px");b=$(window).width()/2-$("#link-container").width()/2;a=Math.round(a)+Math.round(nHeight)-50;$("#link-container").css("top",a+"px");$("#link-container").css("left",b+"px");600>$(window).width()?$("#link-container").css("opacity","0"):$("#link-container").css("opacity","1")};
Window size: x 
Viewport size: x